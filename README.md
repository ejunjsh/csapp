# csapp(e3)
my csapp(e3) homework

exercise reference to https://github.com/DreamAndDead/CSAPP-3e-Solutions

# summary

## è®¡ç®—æœºç³»ç»Ÿæ¼«æ¸¸

> è¿™ä¸€ç« é‡Œé¢åŸºæœ¬æ˜¯å¯¹æ•´æœ¬ä¹¦çš„ä¸€ä¸ªæ¦‚æ‹¬å§ã€‚

* gcc ç¿»è¯‘æºç çš„çš„å››ä¸ªé˜¶æ®µï¼šé¢„å¤„ç†ï¼Œç¼–è¯‘ï¼Œæ±‡ç¼–ï¼Œé“¾æŽ¥
* ç³»ç»Ÿç¡¬ä»¶ç»„æˆï¼šæ€»çº¿ï¼ŒI/Oè®¾å¤‡ï¼Œä¸»å­˜ï¼Œå¤„ç†å™¨
* å­˜å‚¨è®¾å¤‡çš„å±‚æ¬¡ç»“æž„ï¼šL0(å¯„å­˜å™¨)ï¼ŒL1,L2,L3(SRAM),L4(ä¸»å­˜DRAM),L5(ç£ç›˜),L6(...)
* å¹¶å‘è¿è¡Œåˆ™æ˜¯è¯´ä¸€ä¸ªè¿›ç¨‹çš„æŒ‡ä»¤å’Œå¦ä¸€ä¸ªè¿›ç¨‹çš„æŒ‡ä»¤äº¤é”™æ‰§è¡Œçš„
* æ— è®ºæ˜¯åœ¨å•æ ¸è¿˜æ˜¯å¤šæ ¸ç³»ç»Ÿä¸­ï¼Œä¸€ä¸ªCPUçœ‹ä¸ŠåŽ»éƒ½åƒæ˜¯åœ¨å¹¶å‘åœ°æ‰§è¡Œå¤šä¸ªè¿›ç¨‹ï¼Œè¿™æ˜¯é€šè¿‡å¤„ç†å™¨åœ¨è¿›ç¨‹é—´åˆ‡æ¢æ¥å®žçŽ°çš„ã€‚
* æ“ä½œç³»ç»Ÿå®žçŽ°è¿™ç§äº¤é”™æ‰§è¡Œçš„æœºåˆ¶ç§°ä¸ºä¸Šä¸‹æ–‡åˆ‡æ¢
* è™šæ‹Ÿå†…å­˜æ˜¯ä¸€ä¸ªæŠ½è±¡æ¦‚å¿µï¼Œå®ƒä¸ºæ¯ä¸ªè¿›ç¨‹æä¾›ä¸€ä¸ªå‡è±¡ï¼Œå³æ¯ä¸ªè¿›ç¨‹éƒ½æ˜¯ç‹¬å åœ°ä½¿ç”¨ä¸»å­˜ã€‚æ¯ä¸ªè¿›ç¨‹çœ‹åˆ°çš„å†…å­˜éƒ½æ˜¯ä¸€è‡´çš„ï¼Œç§°ä¸ºè™šæ‹Ÿå†…å­˜ç©ºé—´
* æ¯æ¬¡æˆ‘ä»¬è°ƒç”¨ä¸€ä¸ªå‡½æ•°æ—¶ï¼Œæ ˆå°±ä¼šå¢žé•¿ï¼›ä»Žä¸€ä¸ªå‡½æ•°è¿”å›žæ—¶ï¼Œæ ˆå°±ä¼šæ”¶ç¼©
* ä¸€ä¸ªè¿›ç¨‹å®žé™…ä¸Šå¯ä»¥ç”±å¤šä¸ªç§°ä¸ºçº¿ç¨‹çš„æ‰§è¡Œå•ä½ç»„æˆï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½è¿è¡Œåœ¨è¿›ç¨‹çš„ä¸Šä¸‹æ–‡ä¸­ï¼Œå¹¶å…±äº«åŒæ ·çš„ä»£ç å’Œå…¨å±€æ•°æ®ã€‚
* è¶…çº¿ç¨‹æ˜¯ä¸€é¡¹å…è®¸ä¸€ä¸ªcpuæ‰§è¡Œå¤šä¸ªæŽ§åˆ¶æµçš„æŠ€æœ¯
* åˆ©ç”¨ç›´æŽ¥å­˜å‚¨å™¨å­˜å–ï¼ˆDMAï¼‰æŠ€æœ¯ï¼Œæ•°æ®å¯ä»¥ä¸é€šè¿‡å¤„ç†å™¨è€Œç›´æŽ¥ä»Žç£ç›˜åˆ°è¾¾ä¸»å­˜ã€‚


## ä¿¡æ¯çš„è¡¨ç¤ºå’Œå¤„ç†

* å¤§å¤šæ•°è®¡ç®—æœºä½¿ç”¨8ä½çš„å—ï¼Œæˆ–è€…å­—èŠ‚ï¼ˆbyteï¼‰,ä½œä¸ºæœ€å°çš„å¯å¯»å€çš„å†…å­˜å•ä½ï¼Œè€Œä¸æ˜¯è®¿é—®å†…å­˜ä¸­å•ç‹¬çš„ä½ã€‚æœºå™¨çº§ç¨‹åºå°†å†…å­˜è§†ä¸ºä¸€ä¸ªéžå¸¸å¤§çš„å­—èŠ‚æ•°ç»„ï¼Œæˆä¸ºè™šæ‹Ÿå†…å­˜ã€‚å†…å­˜çš„æ¯ä¸ªå­—èŠ‚éƒ½ç”±ä¸€ä¸ªå”¯ä¸€çš„æ•°å­—æ¥è¡¨è¯†ï¼Œç§°ä¸ºå®ƒçš„åœ°å€ï¼Œæ‰€æœ‰å¯èƒ½çš„åœ°å€çš„é›†åˆå°±ç§°ä¸ºè™šæ‹Ÿå†…å­˜ç©ºé—´
* cçš„æŒ‡é’ˆåŒ…å«å€¼å’Œç±»åž‹ï¼Œå®ƒçš„å€¼è¡¨ç¤ºæŸä¸ªå¯¹è±¡çš„ä½ç½®ï¼Œå®ƒçš„ç±»åž‹è¡¨ç¤ºé‚£ä¸ªä½ç½®ä¸Šæ‰€å­˜å‚¨å¯¹è±¡çš„ç±»åž‹
* å¯¹äºŽä¸€ä¸ªå­—é•¿ä¸ºwä½çš„æœºå™¨ï¼Œè™šæ‹Ÿåœ°å€èŒƒå›´ä¸º0ï½ž2^w-1,ç¨‹åºæœ€å¤šè®¿é—®2^wä¸ªå­—èŠ‚
* æœ€ä½Žæœ‰æ•ˆå­—èŠ‚åœ¨æœ€å‰é¢çš„æ–¹å¼ï¼Œç§°ä¸ºå°ç«¯æ³•ï¼Œæœ€é«˜æœ‰æ•ˆå­—èŠ‚åœ¨æœ€å‰é¢çš„æ–¹å¼ï¼Œç§°ä¸ºå¤§ç«¯æ³•ã€‚
* æœ€å¸¸è§çš„æœ‰ç¬¦å·æ•°çš„è®¡ç®—æœºè¡¨ç¤ºæ–¹å¼å°±æ˜¯è¡¥ç 
* å‡ ä¹Žæ‰€æœ‰çš„ç¼–è¯‘å™¨/æœºå™¨ç»„åˆéƒ½å¯¹æœ‰ç¬¦å·æ•°ä½¿ç”¨ç®—æ•°å³ç§»
* å¯¹äºŽå¤§å¤šæ•°cè¯­è¨€çš„å®žçŽ°ï¼Œå¤„ç†åŒæ ·å­—é•¿çš„æœ‰ç¬¦å·æ•°å’Œæ— ç¬¦å·æ•°ä¹‹é—´ç›¸äº’è½¬æ¢çš„ä¸€èˆ¬è§„åˆ™æ˜¯ï¼šæ•°å€¼å¯èƒ½ä¼šæ”¹å˜ï¼Œä½†æ˜¯ä½æ¨¡å¼ä¸å˜
* ä¸¤ä¸ªæ•°çš„wä½è¡¥ç ä¹‹å’Œä¸Žæ— ç¬¦å·ä¹‹å’Œæœ‰å®Œå…¨ç›¸åŒçš„ä½çº§è¡¨ç¤ºï¼Œä¹˜æ³•ä¹Ÿä¸€æ ·

## ç¨‹åºçš„æœºå™¨çº§è¡¨ç¤º

> è¿™ç¯‡æ˜¯æ±‡ç¼–ç›¸å…³ï¼Œç²¾åŽðŸ‘¿

* æ±‡ç¼–ä»£ç æ˜¯æœºå™¨ä»£ç çš„æ–‡æœ¬è¡¨ç¤º
* ç›®æ ‡ä»£ç æ˜¯æœºå™¨ä»£ç çš„ä¸€ç§å½¢å¼ï¼Œå®ƒåŒ…å«æ‰€æœ‰æŒ‡ä»¤çš„äºŒè¿›åˆ¶è¡¨ç¤ºï¼Œä½†æ˜¯è¿˜æ²¡æœ‰å¡«å…¥å…¨å±€å€¼çš„åœ°å€ã€‚
* x86-64çš„è™šæ‹Ÿåœ°å€æ˜¯ç”±64ä½çš„å­—æ¥è¡¨ç¤ºçš„ï¼Œç›®å‰çš„å®žçŽ°ä¸­ï¼Œé«˜16ä½éƒ½å¿…é¡»è®¾ç½®ä¸º0ï¼Œæ‰€ä»¥ä¸€ä¸ªåœ°å€å®žé™…ä¸Šèƒ½å¤ŸæŒ‡å®šçš„æ˜¯2^48æˆ–è€…64TBèŒƒå›´å†…çš„ä¸€ä¸ªå­—èŠ‚ã€‚
* ä¼ é€æŒ‡ä»¤çš„ä¸¤ä¸ªæ“ä½œæ•°ä¸èƒ½éƒ½æŒ‡å‘å†…å­˜ä½ç½®
* ç”±äºŽæ˜¯ä»Ž16ä½ä½“ç³»ç»“æž„æ‰©å±•æˆ32ä½çš„ï¼ŒIntelç”¨æœ¯è¯­â€œå­—(word)â€è¡¨ç¤º16ä½æ•°æ®ç±»åž‹ã€‚å› æ­¤ï¼Œ32ä½æ•°ä¸ºâ€œåŒå­—(double words)â€ï¼Œ64ä½æ•°ä¸ºâ€œå››å­—(quad words)â€
* å‡½æ•°é€šè¿‡æŠŠå€¼å­˜å‚¨åœ¨å¯„å­˜å™¨%raxæˆ–å¯„å­˜å™¨çš„æŸä¸ªä½Žä½éƒ¨åˆ†ä¸­è¿”å›ž
* æ ˆå‘ä¸‹å¢žé•¿ï¼Œæ ˆé¡¶å…ƒç´ çš„åœ°å€æ˜¯æ‰€æœ‰æ ˆä¸­å…ƒç´ åœ°å€ä¸­æœ€ä½Žçš„ï¼Œæ ˆæŒ‡é’ˆ%rspä¿å­˜ç€æ ˆé¡¶å…ƒç´ çš„åœ°å€ã€‚
* è·³è½¬æŒ‡ä»¤æœ‰å‡ ç§ä¸åŒçš„ç¼–ç ï¼Œä½†æ˜¯æœ€å¸¸ç”¨éƒ½æ˜¯PCç›¸å¯¹çš„(PC-relative)
* å°†æ ˆæŒ‡é’ˆå‡å°‘ä¸€ä¸ªé€‚å½“çš„é‡å¯ä»¥ä¸ºæ²¡æœ‰æŒ‡å®šåˆå§‹å€¼çš„æ•°æ®åœ¨æ ˆä¸Šåˆ†é…ç©ºé—´ã€‚ç±»ä¼¼çš„ï¼Œå¯ä»¥é€šè¿‡å¢žåŠ æ ˆæŒ‡é’ˆæ¥é‡Šæ”¾ç©ºé—´
* å½“x86-64è¿‡ç¨‹éœ€è¦çš„å­˜å‚¨ç©ºé—´è¶…å‡ºå¯„å­˜å™¨èƒ½å¤Ÿå­˜æ”¾çš„å¤§å°æ—¶ï¼Œå°±ä¼šåœ¨æ ˆä¸Šåˆ†é…ç©ºé—´ã€‚è¿™ä¸ªéƒ¨åˆ†æˆä¸ºè¿‡ç¨‹çš„æ ˆå¸§(stack frame)
* å¯ä»¥é€šè¿‡å¯„å­˜å™¨æœ€å¤šä¼ é€’6ä¸ªæ•´åž‹ï¼ˆä¾‹å¦‚æ•´æ•°å’ŒæŒ‡é’ˆï¼‰çš„å‚æ•°ï¼Œè¶…å‡º6ä¸ªçš„éƒ¨åˆ†å°±è¦é€šè¿‡æ ˆæ¥ä¼ é€’
* æ ¹æ®æƒ¯ä¾‹ï¼Œå¯„å­˜å™¨%rbx,%rbpå’Œ%r12ï½ž%r15è¢«åˆ’åˆ†ä¸ºè¢«è°ƒç”¨è€…ä¿å­˜å¯„å­˜å™¨
* æ‰€æœ‰å…¶ä»–çš„å¯„å­˜å™¨ï¼Œé™¤äº†æ ˆæŒ‡é’ˆ%rsp,éƒ½åˆ†ç±»ä¸ºè°ƒç”¨è€…ä¿å­˜å¯„å­˜å™¨
* æ•°ç»„å…ƒç´ åœ¨å†…å­˜ä¸­æŒ‰ç…§â€œè¡Œä¼˜å…ˆâ€çš„é¡ºåºæŽ’åˆ—
* ä¸€ä¸ªè”åˆçš„æ€»å¤§å°ç­‰äºŽå®ƒæœ€å¤§å­—æ®µçš„å¤§å°
* å¯¹é½åŽŸåˆ™æ˜¯ä»»ä½•kå­—èŠ‚çš„åŸºæœ¬å¯¹è±¡çš„åœ°å€å¿…é¡»æ˜¯kçš„å€æ•°
* å°†æŒ‡é’ˆä»Žä¸€ç§ç±»åž‹å¼ºåˆ¶è½¬æ¢æˆå¦ä¸€ç§ç±»åž‹ï¼Œåªæ”¹å˜å®ƒçš„ç±»åž‹ï¼Œè€Œä¸æ”¹å˜å®ƒçš„å€¼ï¼ŒæŒ‡é’ˆä¹Ÿå¯ä»¥æŒ‡å‘å‡½æ•°
* ä¸ºäº†ç®¡ç†å˜é•¿æ ˆå¸§ï¼Œx86-64ä»£ç ä½¿ç”¨å¯„å­˜å™¨%rbpä½œä¸ºå¸§æŒ‡é’ˆï¼ˆæœ‰æ—¶å€™ç§°ä¸ºåŸºæŒ‡é’ˆï¼‰

## å¤„ç†å™¨ä½“ç³»ç»“æž„

> æœ¬ä¹¦æœ€éš¾ç« èŠ‚ï¼Œä½†æ˜¯çœ‹å‡ æ¬¡ä¼šæœ‰æƒŠå–œðŸ‘¿

* çŽ°ä»£å¾®å¤„ç†å™¨å¯ä»¥ç§°å¾—ä¸Šæ˜¯äººç±»åˆ›é€ å‡ºçš„æœ€å¤æ‚çš„ç³»ç»Ÿä¹‹ä¸€
* ä¸€ä¸ªå¤„ç†å™¨æ”¯æŒçš„æŒ‡ä»¤å’ŒæŒ‡ä»¤çš„å­—èŠ‚çº§ç¼–ç ç§°ä¸ºå®ƒçš„æŒ‡ä»¤é›†(ISA)
* Y86-64é¡ºåºå®žçŽ°(SEQ)ï¼Œå¤„ç†ä¸€æ¡æŒ‡ä»¤å¯ä»¥åˆ†æˆ5ä¸ªé˜¶æ®µï¼šå–æŒ‡ï¼Œè¯‘ç ï¼Œæ‰§è¡Œï¼Œè®¿å­˜ï¼Œå†™å›žï¼Œæ›´æ–°PC
* æµæ°´çº¿åŒ–(PIPE)é€šè¿‡è®©ä¸åŒçš„é˜¶æ®µå¹¶è¡Œæ“ä½œï¼Œæ”¹è¿›äº†ç³»ç»Ÿçš„åžåé‡æ€§èƒ½ã€‚åœ¨ä»»æ„ä¸€ä¸ªç»™å®šçš„æ—¶åˆ»ï¼Œå¤šæ¡æŒ‡ä»¤è¢«ä¸åŒçš„é˜¶æ®µå¤„ç†

## ä¼˜åŒ–ç¨‹åºæ€§èƒ½

* ç¼–å†™é«˜æ•ˆç¨‹åºéœ€è¦åšåˆ°ä»¥ä¸‹å‡ ç‚¹ï¼šç¬¬ä¸€ï¼Œæˆ‘ä»¬å¿…é¡»é€‰æ‹©ä¸€ç»„é€‚å½“çš„ç®—æ³•å’Œæ•°æ®ç»“æž„ã€‚ç¬¬äºŒï¼Œæˆ‘ä»¬å¿…é¡»ç¼–å†™å‡ºç¼–è¯‘å™¨èƒ½å¤Ÿæœ‰æ•ˆä¼˜åŒ–ä»¥è½¬æ¢æˆé«˜æ•ˆå¯æ‰§è¡Œä»£ç çš„æºä»£ç ã€‚ç¬¬ä¸‰é¡¹æŠ€æœ¯é’ˆå¯¹å¤„ç†è¿ç®—é‡ç‰¹åˆ«å¤§çš„è®¡ç®—ï¼Œå°†ä¸€ä¸ªä»»åŠ¡åˆ†æˆå¤šä¸ªéƒ¨åˆ†ï¼Œè¿™äº›éƒ¨åˆ†å¯ä»¥åœ¨å¤šæ ¸å’Œå¤šå¤„ç†å™¨çš„æŸç§ç»„åˆä¸Šå¹¶è¡Œåœ°è®¡ç®—ã€‚
* åƒå…†èµ«å…¹(Ghz)ä»£è¡¨æ¯ç§’åäº¿å‘¨æœŸ
* æ¶ˆé™¤å¾ªçŽ¯çš„ä½Žæ•ˆçŽ‡
* å‡å°‘è¿‡ç¨‹è°ƒç”¨
* æ¶ˆé™¤ä¸å¿…è¦çš„å†…å­˜å¼•ç”¨
* åœ¨å®žé™…çš„å¤„ç†å™¨ä¸­ï¼Œæ˜¯åŒæ—¶å¯¹å¤šæ¡æŒ‡ä»¤æ±‚å€¼çš„ï¼Œè¿™ä¸ªçŽ°è±¡ç§°ä¸ºæŒ‡ä»¤çº§å¹¶è¡Œ
* å‘å°„æ—¶é—´ä¸º1çš„åŠŸèƒ½å•å…ƒè¢«ç§°ä¸ºå®Œå…¨æµæ°´çº¿åŒ–çš„ï¼ˆfully pipelinedï¼‰ï¼šæ¯ä¸ªæ—¶é’Ÿå‘¨æœŸå¯ä»¥å¼€å§‹ä¸€ä¸ªæ–°çš„è¿ç®—
* å¾ªçŽ¯å±•å¼€
* æé«˜å¹¶è¡Œæ€§ï¼ˆå¤šä¸ªç´¯ç§¯å˜é‡ï¼Œé‡æ–°ç»“åˆå˜æ¢ï¼‰
* å¯„å­˜å™¨æº¢å‡ºï¼šå¦‚æžœæˆ‘ä»¬çš„å¹¶è¡Œåº¦è¶…è¿‡äº†å¯ç”¨çš„å¯„å­˜å™¨æ•°é‡ï¼Œé‚£ä¹ˆç¼–è¯‘å™¨ä¼šå°†æŸäº›ä¸´æ—¶å€¼å­˜æ”¾åˆ°å†…å­˜ä¸­ï¼Œé€šå¸¸æ˜¯åœ¨è¿è¡Œæ—¶å †æ ˆä¸Šåˆ†é…ç©ºé—´
* ä¸è¦è¿‡åˆ†å…³å¿ƒå¯é¢„æµ‹çš„åˆ†æ”¯
* ä¹¦å†™é€‚åˆç”¨æ¡ä»¶ä¼ é€å®žçŽ°çš„ä»£ç 

## å­˜å‚¨å™¨å±‚æ¬¡ç»“æž„

> ç†è§£è¿™ç« ï¼Œä½ ä¼šå‘çŽ°ï¼Œä»€ä¹ˆæŠ€æœ¯éƒ½ç¦»ä¸å¼€ç¼“å­˜ðŸ‘¿

* CPUå¯„å­˜å™¨ä¿å­˜ç€æœ€å¸¸ç”¨çš„æ•°æ®ã€‚é è¿‘CPUçš„å°çš„ï¼Œå¿«é€Ÿçš„é«˜é€Ÿç¼“å­˜å­˜å‚¨å™¨ä½œä¸ºä¸€éƒ¨åˆ†å­˜å‚¨åœ¨ç›¸å¯¹æ…¢é€Ÿçš„ä¸»å­˜å‚¨å™¨ä¸­æ•°æ®å’ŒæŒ‡ä»¤çš„ç¼“å†²åŒºåŸŸã€‚ä¸»å­˜ç¼“å­˜å­˜å‚¨åœ¨å®¹é‡è¾ƒå¤§çš„ï¼Œæ…¢é€Ÿç£ç›˜ä¸Šçš„æ•°æ®ï¼Œè€Œè¿™äº›ç£ç›˜å¸¸å¸¸åˆä½œä¸ºå­˜å‚¨åœ¨é€šè¿‡ç½‘ç»œè¿žæŽ¥çš„å…¶ä»–æœºå™¨çš„ç£ç›˜æˆ–ç£å¸¦ä¸Šçš„æ•°æ®çš„ç¼“å†²åŒºåŸŸã€‚
* å¦‚æžœä½ çš„ç¨‹åºéœ€è¦çš„æ•°æ®æ˜¯å­˜å‚¨åœ¨CPUå¯„å­˜å™¨ä¸­çš„ï¼Œé‚£ä¹ˆåœ¨æŒ‡ä»¤çš„æ‰§è¡ŒæœŸé—´ï¼Œåœ¨0ä¸ªå‘¨æœŸå†…å°±èƒ½è®¿é—®åˆ°å®ƒä»¬ã€‚å¦‚æžœå­˜å‚¨åœ¨é«˜é€Ÿç¼“å­˜ä¸­ï¼Œéœ€è¦4~75ä¸ªå‘¨æœŸã€‚å¦‚æžœå­˜å‚¨åœ¨ä¸»å­˜ä¸­ï¼Œéœ€è¦ä¸Šç™¾ä¸ªå‘¨æœŸã€‚è€Œå¦‚æžœå­˜å‚¨åœ¨ç£ç›˜ä¸­ï¼Œéœ€è¦å¤§çº¦å‡ åƒä¸‡ä¸ªå‘¨æœŸï¼
* éšæœºè®¿é—®å­˜å‚¨å™¨ï¼ˆRAMï¼‰åˆ†ä¸ºä¸¤ç±»ï¼šé™æ€çš„å’ŒåŠ¨æ€çš„ã€‚SRAMç”¨æ¥ä½œä¸ºé«˜é€Ÿç¼“å­˜ï¼ŒDRAMç”¨æ¥ä½œä¸ºä¸»å­˜ã€‚
* æ¯ä¸ªæ‰‡åŒºåŒ…å«ç›¸ç­‰æ•°é‡çš„æ•°æ®ä½ï¼ˆé€šå¸¸æ˜¯512å­—èŠ‚ï¼‰
* ç£ç›˜ä»¥æ‰‡åŒºå¤§å°çš„å—æ¥è¯»å†™æ•°æ®
* å¯¹æ‰‡åŒºçš„è®¿é—®æ—¶é—´æœ‰ä¸‰ä¸ªä¸»è¦çš„éƒ¨åˆ†ï¼šå¯»é“æ—¶é—´ï¼Œæ—‹è½¬æ—¶é—´ï¼Œä¼ é€æ—¶é—´
* ç£ç›˜å°è£…ä¸­æœ‰ä¸€ä¸ªå°çš„ç¡¬ä»¶/å›ºä»¶è®¾å¤‡ï¼Œç§°ä¸ºç£ç›˜æŽ§åˆ¶å™¨ï¼Œç»´æŠ¤ç€é€»è¾‘å—å·å’Œå®žé™…ï¼ˆç‰©ç†ï¼‰ç£ç›˜æ‰‡åŒºä¹‹é—´çš„æ˜ å°„å…³ç³»
* åœ¨ç£ç›˜æŽ§åˆ¶å™¨æ”¶åˆ°æ¥è‡ªCPUçš„è¯»å‘½ä»¤ä¹‹åŽï¼Œå®ƒå°±è®²é€»è¾‘å—å·ç¿»è¯‘æˆä¸€ä¸ªæ‰‡åŒºåœ°å€ï¼Œè¯»è¯¥æ‰‡åŒºçš„å†…å®¹ï¼Œç„¶åŽå°†è¿™äº›å†…å®¹ç›´æŽ¥ä¼ é€åˆ°ä¸»å­˜ï¼Œä¸éœ€è¦CPUçš„å¹²æ¶‰ã€‚
* è®¾å¤‡å¯ä»¥è‡ªå·±æ‰§è¡Œè¯»æˆ–è€…å†™æ€»çº¿äº‹åŠ¡è€Œä¸éœ€è¦CPUå¹²æ¶‰çš„è¿‡ç¨‹ï¼Œç§°ä¸ºç›´æŽ¥å†…å­˜è®¿é—®(DMA)
* æ—¶é—´å±€éƒ¨æ€§ï¼šåœ¨ä¸€ä¸ªå…·æœ‰è‰¯å¥½æ—¶é—´å±€éƒ¨æ€§çš„ç¨‹åºä¸­ï¼Œè¢«å¼•ç”¨è¿‡ä¸€æ¬¡çš„å†…å­˜ä½ç½®å¾ˆå¯èƒ½åœ¨ä¸è¿œçš„å°†æ¥å†è¢«å¤šæ¬¡å¼•ç”¨
* ç©ºé—´å±€éƒ¨æ€§ï¼šåœ¨ä¸€ä¸ªå…·æœ‰è‰¯å¥½ç©ºé—´å±€éƒ¨æ€§çš„ç¨‹åºä¸­ï¼Œå¦‚æžœä¸€ä¸ªå†…å­˜ä½ç½®è¢«å¼•ç”¨äº†ä¸€æ¬¡ï¼Œé‚£ä¹ˆç¨‹åºå¾ˆå¯èƒ½åœ¨ä¸è¿œçš„å°†æ¥å¼•ç”¨é™„è¿‘çš„ä¸€ä¸ªå†…å­˜ä½ç½®
* é«˜é€Ÿç¼“å­˜å­˜å‚¨å™¨ï¼šç›´æŽ¥æ˜ å°„é«˜é€Ÿç¼“å­˜ï¼Œç»„ç›¸è”é«˜é€Ÿç¼“å­˜ï¼Œå…¨ç›¸è”é«˜é€Ÿç¼“å­˜
* å†™å›žé«˜é€Ÿç¼“å­˜é€šå¸¸æ˜¯å†™åˆ†é…
* ç¼–å†™é«˜é€Ÿç¼“å­˜å‹å¥½çš„ä»£ç 

## é“¾æŽ¥

* é™æ€é“¾æŽ¥ï¼šåƒLinux `ld`ç¨‹åºè¿™æ ·çš„é™æ€é“¾æŽ¥å™¨(static linker)ä»¥ä¸€ç»„å¯é‡å®šä½ç›®æ ‡æ–‡ä»¶å’Œå‘½ä»¤è¡Œå‚æ•°ä½œä¸ºè¾“å…¥ï¼Œç”Ÿæˆä¸€ä¸ªå®Œå…¨é“¾æŽ¥çš„ï¼Œå¯ä»¥åŠ è½½å’Œè¿è¡Œçš„å¯æ‰§è¡Œç›®æ ‡æ–‡ä»¶ä½œä¸ºè¾“å‡º
* ç›®æ ‡æ–‡ä»¶æœ‰ä¸‰ç§å½¢å¼ï¼šå¯é‡å®šä½ç›®æ ‡æ–‡ä»¶ï¼Œå¯æ‰§è¡Œç›®æ ‡æ–‡ä»¶ï¼Œå…±äº«ç›®æ ‡æ–‡ä»¶
* ELF(Executable and Linkable Format)
* é“¾æŽ¥å™¨å¦‚ä½•è§£æžå¤šé‡å®šä¹‰çš„å…¨å±€ç¬¦å·ï¼šå‡½æ•°å’Œå·²åˆå§‹åŒ–çš„å…¨å±€å˜é‡æ˜¯å¼ºç¬¦å·ï¼Œæœªåˆå§‹åŒ–çš„å…¨å±€å˜é‡æ˜¯å¼±ç¬¦å·
    * ä¸å…è®¸æœ‰å¤šä¸ªåŒåçš„å¼ºç¬¦å·
    * å¦‚æžœæœ‰ä¸€ä¸ªå¼ºç¬¦å·å’Œå¤šä¸ªå¼±ç¬¦å·åŒåï¼Œé‚£ä¹ˆé€‰æ‹©å¼ºç¬¦å·
    * å¦‚æžœæœ‰å¤šä¸ªå¼±ç¬¦å·åŒåï¼Œé‚£ä¹ˆä»Žè¿™äº›å¼±ç¬¦å·ä¸­ä»»æ„é€‰æ‹©ä¸€ä¸ª
* å°†å¤šæœ‰ç›¸å…³çš„ç›®æ ‡æ¨¡å—æ‰“åŒ…æˆä¸ºä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶ï¼Œç§°ä¸ºé™æ€åº“
* linuxç¨‹åºéƒ½å¯ä»¥é€šè¿‡è°ƒç”¨`execve`å‡½æ•°æ¥è°ƒç”¨åŠ è½½å™¨,åŠ è½½å™¨å°†å¯æ‰§è¡Œç›®æ ‡æ–‡ä»¶ä¸­çš„ä»£ç å’Œæ•°æ®ä»Žç£ç›˜å¤åˆ¶åˆ°å†…å­˜ä¸­ï¼Œç„¶åŽé€šè¿‡è·³è½¬åˆ°ç¨‹åºçš„ç¬¬ä¸€æ¡æŒ‡ä»¤æˆ–å…¥å£ç‚¹æ¥è¿è¡Œç¨‹åº
* åŠ¨æ€é“¾æŽ¥å…±äº«åº“åœ¨å†…å­˜ä¸­çš„`.text`èŠ‚çš„ä¸€ä¸ªå‰¯æœ¬å¯ä»¥è¢«ä¸åŒçš„æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹å…±äº«
* å¯ä»¥åŠ è½½è€Œæ— éœ€é‡å®šä½çš„ä»£ç ç§°ä¸ºä½ç½®æ— å…³ä»£ç (PIC),å…±äº«åº“çš„ç¼–è¯‘å¿…é¡»æ€»æ˜¯ä½¿ç”¨è¯¥é€‰é¡¹
* é“¾æŽ¥å¯ä»¥åœ¨ç¼–è¯‘æ—¶ç”±é™æ€ç¼–è¯‘å™¨æ¥å®Œæˆï¼Œä¹Ÿå¯ä»¥åœ¨åŠ è½½æ—¶å’Œè¿è¡Œæ—¶ç”±åŠ¨æ€é“¾æŽ¥å™¨æ¥å®Œæˆ
* é“¾æŽ¥å™¨çš„ä¸¤ä¸ªä¸»è¦ä»»åŠ¡æ˜¯ç¬¦å·è§£æžå’Œé‡å®šä½ï¼Œç¬¦å·è§£æžå°†ç›®æ ‡æ–‡ä»¶ä¸­çš„æ¯ä¸ªå…¨å±€ç¬¦å·éƒ½ç»‘å®šåˆ°ä¸€ä¸ªå”¯ä¸€çš„å®šä¹‰ï¼Œè€Œé‡å®šä½ç¡®å®šæ¯ä¸ªç¬¦å·çš„æœ€ç»ˆå†…å­˜åœ°å€ï¼Œå¹¶ä¿®æ”¹å¯¹é‚£äº›ç›®æ ‡çš„å¼•ç”¨

## å¼‚å¸¸æŽ§åˆ¶æµ

* ä¸€ä¸ªç¡¬ä»¶å®šæ—¶å™¨å®šæœŸäº§ç”Ÿä¿¡å·ï¼Œè¿™ä¸ªäº‹ä»¶å¿…é¡»å¾—åˆ°å¤„ç†ã€‚åŒ…åˆ°è¾¾ç½‘ç»œé€‚é…å™¨åŽï¼Œå¿…é¡»å­˜æ”¾åœ¨å†…å­˜ä¸­ã€‚ç¨‹åºå‘ç£ç›˜è¯·æ±‚æ•°æ®ï¼Œç„¶åŽä¼‘çœ ï¼Œç›´åˆ°è¢«é€šçŸ¥è¯´æ•°æ®å·²å°±ç»ªã€‚å½“å­è¿›ç¨‹ç»ˆæ­¢æ—¶ï¼Œåˆ›é€ è¿™äº›å­è¿›ç¨‹çš„çˆ¶è¿›ç¨‹å¿…é¡»å¾—åˆ°é€šçŸ¥
* å¼‚å¸¸çš„ç±»åž‹ï¼šä¸­æ–­ï¼Œé™·é˜±å’Œç³»ç»Ÿè°ƒç”¨ï¼Œæ•…éšœï¼Œç»ˆæ­¢
* æ‰€æœ‰åˆ°Linuxç³»ç»Ÿè°ƒç”¨çš„å‚æ•°éƒ½æ˜¯é€šè¿‡å¯„å­˜å™¨è€Œä¸æ˜¯æ ˆä¼ é€’çš„ï¼Œå¯„å­˜å™¨%raxåŒ…å«ç³»ç»Ÿè°ƒç”¨å·ã€‚
* å½“å†…æ ¸ä»£è¡¨ç”¨æˆ·æ‰§è¡Œç³»ç»Ÿè°ƒç”¨æ—¶ï¼Œå¯èƒ½ä¼šå‘ç”Ÿä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œä¾‹å¦‚`read`ç³»ç»Ÿè°ƒç”¨
* ä¸­æ–­ä¹Ÿå¯èƒ½å¼•å‘ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œä¾‹å¦‚ç³»ç»Ÿçš„å®šæ—¶å™¨åˆ°æ—¶é—´äº†ï¼Œä¼šæŠŠè¿è¡Œè¿‡ä¹…çš„è¿›ç¨‹è°ƒåº¦å‡ºåŽ»
* `fork`ç³»ç»Ÿè°ƒç”¨åˆ›å»ºçš„å­è¿›ç¨‹å‡ ä¹Žä½†ä¸å®Œå…¨ä¸Žçˆ¶è¿›ç¨‹ç›¸åŒã€‚
* å¦‚æžœä¸€ä¸ªçˆ¶è¿›ç¨‹ç»ˆæ­¢äº†ï¼Œå†…æ ¸ä¼šå®‰æŽ’initè¿›ç¨‹æˆä¸ºå®ƒçš„å­¤å„¿è¿›ç¨‹çš„å…»çˆ¶


## è™šæ‹Ÿå†…å­˜

> è¿™ä¸€ç« æ˜¯å…¨ä¹¦æœ€ç²¾åŽçš„åœ°æ–¹ï¼Œç†è§£è™šæ‹Ÿå†…å­˜ï¼Œå¾ˆå¤šå†…å­˜é—®é¢˜çš„ç–‘é—®éƒ½èƒ½å¤Ÿåœ¨è¿™é‡Œæ‰¾åˆ°ðŸ‘¿

* è™šæ‹Ÿå†…å­˜æä¾›äº†ä¸‰ä¸ªé‡è¦çš„èƒ½åŠ›ï¼Œ1. å®ƒå°†ä¸»å­˜çœ‹æˆæ—¶ä¸€ä¸ªå­˜å‚¨åœ¨ç£ç›˜ä¸Šçš„åœ°å€ç©ºé—´çš„é«˜é€Ÿç¼“å­˜ï¼Œåœ¨ä¸»å­˜ä¸­åªä¿å­˜æ´»åŠ¨åŒºåŸŸï¼Œå¹¶æ ¹æ®éœ€è¦åœ¨ç£ç›˜å’Œä¸»å­˜ä¹‹é—´æ¥å›žä¼ é€æ•°æ®ï¼Œé€šè¿‡è¿™ç§æ–¹å¼ï¼Œå®ƒé«˜æ•ˆåœ°ä½¿ç”¨äº†ä¸»å­˜ã€‚2. å®ƒä¸ºæ¯ä¸ªè¿›ç¨‹æä¾›äº†ä¸€è‡´çš„åœ°å€ç©ºé—´ï¼Œä»Žè€Œç®€åŒ–äº†å†…å­˜ç®¡ç†ã€‚3. å®ƒä¿æŠ¤äº†æ¯ä¸ªè¿›ç¨‹çš„åœ°å€ç©ºé—´ä¸è¢«å…¶ä»–è¿›ç¨‹ç ´å
* å› ä¸ºå¯¹ç£ç›˜çš„è®¿é—®æ—¶é—´å¾ˆé•¿ï¼ŒDRAMç¼“å­˜æ€»æ˜¯ä½¿ç”¨å†™ä¼šï¼Œè€Œä¸æ˜¯ç›´å†™
* DRAMç¼“å­˜ä¸å‘½ä¸­ç§°ä¸ºç¼ºé¡µ
* åŠ è½½å™¨ä»Žä¸ä»Žç£ç›˜åˆ°å†…å­˜å®žé™…å¤åˆ¶ä»»ä½•æ•°æ®ï¼Œè™šæ‹Ÿå†…å­˜ç³»ç»Ÿä¼šæŒ‰ç…§éœ€è¦è‡ªåŠ¨åœ°è°ƒå…¥æ•°æ®é¡µ
* TLBæ˜¯ä¸€ä¸ªå°çš„ï¼Œè™šæ‹Ÿå¯»å€çš„ç¼“å­˜
* c++ä¸­çš„newå’Œdeleteæ“ä½œç¬¦ä¸Žcä¸­çš„mallocå’Œfreeç›¸å½“
* é¦–æ¬¡é€‚é…ä»Žå¤´å¼€å§‹æœç´¢ç©ºé—²é“¾è¡¨ï¼Œé€‰æ‹©ç¬¬ä¸€ä¸ªåˆé€‚çš„ç©ºé—²å—
* ä¸‹ä¸€æ¬¡é€‚é…å’Œé¦–æ¬¡é€‚é…å¾ˆç›¸ä¼¼ï¼Œåªä¸è¿‡ä¸æ˜¯ä»Žé“¾è¡¨çš„èµ·å§‹å¤„å¼€å§‹æ¯æ¬¡æœç´¢ï¼Œè€Œæ˜¯ä»Žä¸Šä¸€æ¬¡æŸ¥è¯¢ç»“æŸçš„åœ°æ–¹å¼€å§‹ã€‚
* æœ€ä½³é€‚é…æ£€æŸ¥æ¯ä¸ªç©ºé—²å—ï¼Œé€‰æ‹©é€‚åˆæ‰€éœ€è¯·æ±‚å¤§å°çš„æœ€å°ç©ºé—²å—
* å†…éƒ¨ç¢Žç‰‡æ˜¯åœ¨ä¸€ä¸ªå·²åˆ†é…å—æ¯”æœ‰æ•ˆè½½è·æ—¶å‘ç”Ÿçš„
* å¤–éƒ¨ç¢Žç‰‡æ˜¯å½“ç©ºé—²å†…å­˜åˆè®¡èµ·æ¥è¶³å¤Ÿæ»¡è¶³ä¸€ä¸ªåˆ†é…è¯·æ±‚ï¼Œä½†æ˜¯æ²¡æœ‰ä¸€ä¸ªå•ç‹¬çš„ç©ºé—²å—è¶³å¤Ÿå¤§å¯ä»¥æ¥å¤„ç†è¿™ä¸ªè¯·æ±‚æ—¶å‘ç”Ÿçš„

## ç³»ç»Ÿçº§I/O
* è¾“å…¥/è¾“å‡ºï¼ˆI/Oï¼‰æ˜¯åœ¨ä¸»å­˜å’Œå¤–éƒ¨è®¾å¤‡ï¼ˆä¾‹å¦‚ç£ç›˜é©±åŠ¨å™¨ï¼Œç»ˆç«¯å’Œç½‘ç»œï¼‰ä¹‹é—´å¤åˆ¶æ•°æ®çš„è¿‡ç¨‹ã€‚è¾“å…¥æ“ä½œæ˜¯ä»ŽI/Oè®¾å¤‡å¤åˆ¶æ•°æ®åˆ°ä¸»å­˜ï¼Œè€Œè¾“å‡ºæ“ä½œæ˜¯ä»Žä¸»å­˜å¤åˆ¶æ•°æ®åˆ°I/Oè®¾å¤‡ã€‚
* åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œreadå’Œwriteä¼ é€çš„å­—èŠ‚æ¯”åº”ç”¨ç¨‹åºè¦æ±‚çš„è¦å°‘ã€‚å‡ºçŽ°è¿™æ ·æƒ…å†µçš„åŽŸå› æœ‰ï¼š
    * è¯»æ—¶é‡åˆ°EOF
    * ä»Žç»ˆç«¯è¯»æ–‡æœ¬è¡Œ
    * è¯»å’Œå†™ç½‘ç»œå¥—æŽ¥å­—
* é™¤äº†EOF,å½“ä½ åœ¨è¯»ç£ç›˜æ–‡ä»¶æ—¶ï¼Œå°†ä¸ä¼šé‡åˆ°ä¸è¶³å€¼ï¼Œè€Œä¸”åœ¨å†™ç£ç›˜æ–‡ä»¶æ—¶ï¼Œä¹Ÿä¸ä¼šé‡åˆ°ä¸è¶³å€¼ã€‚
* å…±äº«æ–‡ä»¶ï¼šæ¯ä¸ªè¿›ç¨‹éƒ½æœ‰å®ƒè‡ªå·±å•ç‹¬çš„æè¿°ç¬¦è¡¨ï¼Œè€Œæ‰€æœ‰çš„è¿›ç¨‹å…±äº«åŒä¸€ä¸ªæ–‡ä»¶è¡¨å’Œv-nodeè¡¨


## ç½‘ç»œç¼–ç¨‹
* ä»Žç½‘ç»œä¸ŠæŽ¥æ”¶åˆ°åˆ°æ•°æ®ä»Žé€‚é…å™¨ç»è¿‡I/Oå’Œå†…å­˜æ€»çº¿å¤åˆ¶åˆ°å†…å­˜ï¼Œé€šå¸¸æ˜¯é€šè¿‡DMAä¼ é€ã€‚ç›¸ä¼¼åœ°ï¼Œæ•°æ®ä¹Ÿèƒ½ä»Žå†…å­˜å¤åˆ¶åˆ°ç½‘ç»œ
* é›†çº¿å™¨ä¸åŠ åˆ†è¾¨åœ°å°†ä»Žä¸€ä¸ªç«¯å£ä¸Šæ”¶åˆ°åœ°æ¯ä¸ªä½å¤åˆ¶åˆ°å…¶ä»–æ‰€æœ‰åœ°ç«¯å£ä¸Šã€‚å› æ­¤ï¼Œæ¯å°ä¸»æœºéƒ½èƒ½çœ‹åˆ°æ¯ä¸ªä½.
* å…³äºŽEOFï¼šEOFæ˜¯ç”±å†…æ ¸æ£€æµ‹åˆ°çš„ä¸€ç§æ¡ä»¶ã€‚åº”ç”¨ç¨‹åºåœ¨å®ƒæŽ¥æ”¶åˆ°ä¸€ä¸ªç”±readå‡½æ•°è¿”å›žåœ°é›¶è¿”å›žç æ—¶ï¼Œå®ƒå°±ä¼šå‘çŽ°å‡ºEOFæ¡ä»¶ã€‚å¯¹äºŽç£ç›˜æ–‡ä»¶ï¼Œå½“å‰æ–‡ä»¶ä½ç½®è¶…å‡ºæ–‡ä»¶é•¿åº¦æ—¶ï¼Œä¼šå‘ç”ŸEOFã€‚å¯¹äºŽå› ç‰¹ç½‘è¿žæŽ¥ï¼Œå½“ä¸€ä¸ªè¿›ç¨‹å…³é—­è¿žæŽ¥å®ƒçš„é‚£ä¸€ç«¯æ—¶ï¼Œä¼šå‘ç”ŸEOFã€‚è¿žæŽ¥å¦ä¸€ç«¯åœ°è¿›ç¨‹åœ¨è¯•å›¾è¯»å–æµä¸­æœ€åŽä¸€ä¸ªå­—èŠ‚ä¹‹åŽçš„å­—èŠ‚æ—¶ï¼Œä¼šæ£€æµ‹åˆ°EOFã€‚


> to be continue....